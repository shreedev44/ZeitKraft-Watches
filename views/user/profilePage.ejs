<%- include('../layout/header') -%>

<%- include('../layout/userSideCss') -%>

    <!-- Bootstrap CSS -->
    <title>ZEITKRAFT | User profile</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://kit.fontawesome.com/your-fontawesome-kit-code.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/UserAssets/css/profile.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    
  </head>

  <body>
    <%- include('../layout/navbar') -%>

    <section class="breadcrumb-option">
      <div class="container">
          <div class="row">
              <div class="col-lg-12">
                  <div class="breadcrumb__text">
                      <h4>Profile</h4>
                      <div class="breadcrumb__links">
                          <a href="/home">Home</a>
                          <a href="/profile">Profile</a>
                          <span>Proifle Information</span>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </section>

    <section class="my-5 d-flex justify-content-around">
      <div class="container">
        <div class="main-body">
          <div class="row d-flex justify-content-around">
            <div class="col-lg-4">
              <div class="card border-0">
                <div class="card-body">
                  <div class="list-group list-group-flush text-start mt-4">
                    <a
                      href="/profile"
                      class="list-group-item list-group-item-action border-0 active"
                    >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill icon-align" viewBox="0 0 16 16">
                        <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
                      </svg> Profile Informaton
                    </a>
                    <a
                      href="/wishlist"
                      class="list-group-item list-group-item-action border-0"
                    >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart-fill icon-align" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                      </svg> Wishlist
                    </a>
                    <a
                      href="/orders"
                      class="list-group-item list-group-item-action border-0"
                      ><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-fill icon-align" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M15.528 2.973a.75.75 0 0 1 .472.696v8.662a.75.75 0 0 1-.472.696l-7.25 2.9a.75.75 0 0 1-.557 0l-7.25-2.9A.75.75 0 0 1 0 12.331V3.669a.75.75 0 0 1 .471-.696L7.443.184l.004-.001.274-.11a.75.75 0 0 1 .558 0l.274.11.004.001zm-1.374.527L8 5.962 1.846 3.5 1 3.839v.4l6.5 2.6v7.922l.5.2.5-.2V6.84l6.5-2.6v-.4l-.846-.339Z"/>
                      </svg> Orders</a
                    >

                    <a
                      href="/addresses"
                      class="list-group-item list-group-item-action border-0"
                    >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-postcard-fill icon-align" viewBox="0 0 16 16">
                        <path d="M11 8h2V6h-2z"/>
                        <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm8.5.5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0zM2 5.5a.5.5 0 0 0 .5.5H6a.5.5 0 0 0 0-1H2.5a.5.5 0 0 0-.5.5M2.5 7a.5.5 0 0 0 0 1H6a.5.5 0 0 0 0-1zM2 9.5a.5.5 0 0 0 .5.5H6a.5.5 0 0 0 0-1H2.5a.5.5 0 0 0-.5.5m8-4v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5"/>
                      </svg> Addresses
                    </a>
                    <a
                      href="/wallet"
                      class="list-group-item list-group-item-action border-0"
                    >
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-wallet-fill icon-align" viewBox="0 0 16 16">
                        <path d="M1.5 2A1.5 1.5 0 0 0 0 3.5v2h6a.5.5 0 0 1 .5.5c0 .253.08.644.306.958.207.288.557.542 1.194.542s.987-.254 1.194-.542C9.42 6.644 9.5 6.253 9.5 6a.5.5 0 0 1 .5-.5h6v-2A1.5 1.5 0 0 0 14.5 2z"/>
                        <path d="M16 6.5h-5.551a2.7 2.7 0 0 1-.443 1.042C9.613 8.088 8.963 8.5 8 8.5s-1.613-.412-2.006-.958A2.7 2.7 0 0 1 5.551 6.5H0v6A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5z"/>
                      </svg> Wallet
                    </a>
                    <a
                      href="/logout"
                      class="list-group-item list-group-item-action border-0"
                      ><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-power icon-align" viewBox="0 0 16 16">
                        <path d="M7.5 1v7h1V1z"/>
                        <path d="M3 8.812a5 5 0 0 1 2.578-4.375l-.485-.874A6 6 0 1 0 11 3.616l-.501.865A5 5 0 1 1 3 8.812"/>
                      </svg> Logout</a
                    >
                  </div>
                </div>
              </div>
            </div>
            <div id="profile-data-div" class="col-lg-8">
              <div id="profileDetails" class="card">
                <h3 class="text-dark m-5">Profile Information</h3>
                <div class="card-body mt-3">
                  <div
                    class="d-flex flex-column align-items-center text-center"
                  >
                    <img
                      src="/uploads/profile/<%=user.profilePic%>"
                      alt="Profile pic"
                      class="rounded-circle p-1 bg-warning"
                      width="110" 
                      id="profile-pic" 
                      onerror="this.onerror=null;this.src='/UserAssets/images/pic-4.png';"
                    />
                    <div class="mt-3">
                      <h4>Hello</h4>
                      <h4><%= user.firstName + ' ' + user.lastName %> !</h4>
                    </div>
                  </div>
                  <div class="profile-info mt-5">
                    <p><strong>First Name:</strong> <%= user.firstName %></p>
                    <p><strong>Last Name:</strong> <%= user.lastName %></p>
                    <p>
                      <strong>Email Address:</strong>
                      <%= user.email %>
                    </p>
                    <% if(user.phone){ %>
                    <p><strong>Contact:</strong> <%= "+"+user.phone %> </p>
                    <% } else{ %>
                    <p><strong>Contact:</strong><span class="mx-3">Not added</span> </p>
                    <% } %>

                    <button id="edit-profile" class="btn btn-outline-navy mt-5">
                      Edit profile data
                    </button>
                    <hr>

                    <h5 class="mt-4 text-navy">Refer a friend and earn</h5>
                    <p>You can refer a friend to earn Rs. 100 to your wallet. Your friend will be getting Rs. 50 to their wallet when signing up with your referal link.</p>
                    <button class="btn btn-outline-navy" id="referral-btn">
                      Get your referral link
                    </button>
                  </div>
                </div>
              </div>              
            </div>

            <div id="edit-profile-div" class="col-lg-8" style="display: none;">
              <div id="profileDetails" class="card">
                <h3 class="text-dark m-5">Edit Profile</h3>
                <div class="card-body mt-3">
                  <div
                    class="d-flex flex-column align-items-center text-center"
                  >
                    <img
                      src="/uploads/profile/<%=user.profilePic%>"
                      alt="Profile pic"
                      class="rounded-circle p-1 bg-warning"
                      width="110" 
                      id="profile-pic-preview" 
                      onerror="this.onerror=null;this.src='/UserAssets/images/pic-4.png';"
                    />
                    <label for="profile-pic" id="change-profile" class="profile-link" data-profile="<%= user.profilePic %>">Change Profile picture</label>
                    <label for="profile-pic" id="add-profile" class="profile-link">Add Profile picture</label>
                    <% if(user.profilePic){ %>
                    <% } else{ %>
                    <% } %>
                    <input type="file" name="profilePic" class="profile-pic-input" style="opacity: 0; position: absolute; z-index: -20;">
                    <input type="file" id="profile-input" style="display: none;">
                  </div>
                  <div class="profile-info mt-5">
                    <div class="form-container">
                      <div class="mb-3">
                        <label for="first-name" class="form-label">First Name</label><span id="fname-error" class="ml-3 text-danger fs-1"></span>
                        <input type="text" class="form-control" id="first-name" aria-describedby="emailHelp" value="<%= user.firstName %>">
                      </div>
                      <div class="mb-3">
                        <label for="last-name" class="form-label">Last Name</label><span id="lname-error" class="ml-3 text-danger fs-1"></span>
                        <input type="text" class="form-control" id="last-name" value="<%= user.lastName %>">
                      </div>
                      <div class="mb-3">
                        <label for="phone" class="form-label">Phone</label><span id="phone-error" class="ml-3 text-danger fs-1"></span>
                        <input type="text" class="form-control" id="phone" value="<%= user.phone ? '+' + user.phone : '' %>">
                      </div>
                      <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="text" class="form-control" value="<%= user.email %>" disabled>
                        <div class="d-flex justify-content-between">
                          <% if(user.password){ %>
                          <span id="change-email" class="profile-link fs-1 mt-2">Change email</span>
                          <span id="change-password" class="profile-link fs-1 mt-2">Change password</span>
                          <% } else { %>
                            <p class="text-navy">You won't be able to change your email or password as you have signed in with your social account</p>
                          <% } %>
                        </div>
                        
                      </div>
                      <button id="edit-cancel-btn" type="submit" class="btn btn-outline-primary rounded-0 mt-3 mr-3">Cancel</button>
                      <button id="profile-submit-btn" type="submit" data-user-id="<%= user._id %>" class="btn btn-primary rounded-0 btn-disabled disabled mt-3">Submit</button>
                      </div>
                  </div>
                </div>
              </div>              
            </div>
            

            <div id="change-email-div" class="col-lg-8" style="display: none;">
              <div id="profileDetails" class="card">
                <h3 class="text-dark m-5">Change Email</h3>
                <div class="card-body">
                  <div class="d-flex justify-content-center">
                    <span class="text-navy">An OTP will be sent to this email address to verify</span>
                  </div>
                  <div class="profile-info">
                    <div class="form-container">
                      <div class="mb-3">
                        <label for="email" class="form-label">New Email</label><span id="email-error" class="ml-3 text-danger fs-1"></span>
                        <input type="text" class="form-control" id="email">
                        
                      </div>
                      <button id="email-cancel-btn" type="submit" class="btn btn-outline-primary rounded-0 mt-3 mr-3">Cancel</button>
                      <button id="email-submit-btn" type="submit" data-user-id="<%= user._id %>" data-current-email="<%= user.email %>" class="btn btn-primary rounded-0 btn-disabled disabled mt-3">Submit</button>
                      </div>
                  </div>
                </div>
              </div>              
            </div>

            <div id="otp-div" class="col-lg-8" style="display: none;">
              <div id="profileDetails" class="card">
                <h3 class="text-dark m-5">Verify OTP</h3>
                <div class="card-body">
                  <div class="d-flex justify-content-center">
                    <span id="otp-message" class="text-navy"></span>
                  </div>
                  <div class="profile-info">
                    <div class="form-container">
                      <div class="mb-3">
                        <label for="otp" class="form-label">OTP</label><span id="otp-error" class="ml-3 text-danger fs-1"></span>
                        <input type="text" class="form-control" id="otp">
                      </div>
                      <button id="otp-cancel-btn" type="submit" class="btn btn-outline-primary rounded-0 mt-3 mr-3">Cancel</button>
                      <button id="otp-submit-btn" data-user-id="<%= user._id %>" type="submit" class="btn btn-primary rounded-0 btn-disabled disabled mt-3">Submit</button>
                      </div>
                  </div>
                </div>
              </div>              
            </div>

            <div id="change-password-div" class="col-lg-8" style="display: none;">
              <div id="profileDetails" class="card">
                <h3 class="text-dark m-5">Change Password</h3>
                <div class="card-body">
                  <div class="profile-info">
                    <div class="form-container">
                      <div class="mb-3">
                        <label for="exampleInputPassword1" class="form-label">Current Password</label><span id="current-password-error" class="ml-3 text-danger fs-1"></span>
                        <div class="input-group">
                          <input type="password" class="form-control password-toggle" id="current-password">
                          <div class="input-group-append">
                            <label class="input-group-text bg-white border-radius-0" for="password-toggle">
                              <span class="fa fa-fw fa-eye field-icon toggle-current-password"></span>
                            </label>
                          </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label for="exampleInputPassword1" class="form-label">New Password</label><span id="new-password-error" class="ml-3 text-danger fs-1"></span>
                        <div class="input-group">
                          <input type="password" class="form-control password-toggle" id="new-password">
                          <div class="input-group-append">
                            <label class="input-group-text bg-white border-radius-0" for="password-toggle">
                              <span class="fa fa-fw fa-eye field-icon toggle-new-password"></span>
                            </label>
                          </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label for="exampleInputPassword1" class="form-label password-toggle">Confirm Password</label><span id="confirm-password-error" class="ml-3 text-danger fs-1"></span>
                        <div class="input-group">
                          <input type="password" class="form-control" id="confirm-password">
                          <div class="input-group-append">
                            <label class="input-group-text bg-white border-radius-0" for="password-toggle">
                              <span class="fa fa-fw fa-eye field-icon toggle-confirm-password"></span>
                            </label>
                          </div>
                        </div>
                      </div>
                      <div class="d-flex justify-content-end">
                        <!-- <a href="/forgot-password">Forgot Password</a> -->
                      </div>
                      <button id="password-cancel-btn" type="submit" class="btn btn-outline-primary rounded-0 mt-3 mr-3">Cancel</button>
                      <button id="password-submit-btn" data-user-id="<%= user._id %>" type="submit" class="btn btn-primary rounded-0 btn-disabled disabled mt-3">Submit</button>
                      </div>
                  </div>
                </div>
              </div>              
            </div>

          </div>
        </div>
      </div>
    </section>

    <%- include('../layout/pageFooter') -%>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    
    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="/UserAssets/js/profile.js"></script>
    <script src="/UserAssets/js/editProfile.js"></script>
    <%- include('../layout/userSideScripts') -%>
  </body>
</html>
